Here's a SQL to identify the top 10 cities that fall within the top 10 countries.

SELECT
ci.city AS city,
co.country AS country,
COUNT(c.customer_id) AS customer_count
FROM customer c
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
JOIN country co ON ci.country_id = co.country_id
WHERE co.country IN (
SELECT co.country
FROM customer c
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
JOIN country co ON ci.country_id = co.country_id
GROUP BY co.country
ORDER BY COUNT(c.customer_id) DESC
LIMIT 10
)
GROUP BY ci.city, co.country
ORDER BY customer_count DESC
LIMIT 10;
